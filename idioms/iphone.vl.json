{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "background": "#f2f2f2",
  "data": {
    "url": "https://raw.githubusercontent.com/lawchrisss/FIT3179_DataVisualisation2/refs/heads/main/datasets/days_to_own.csv",
    "format": { "type": "csv" }
  },
  "transform": [
    { "calculate": "datum.Country === 'United Arab Emirates' ? 'Emirates' : datum.Country", "as": "CountryLabel" },
    { "calculate": "toNumber(datum.Days_Needed)", "as": "days" },
    { "calculate": "1", "as": "days_per_emoji" },
    { "calculate": "100", "as": "wrap_per_row" },
    { "calculate": "ceil(datum.days / datum.days_per_emoji)", "as": "icons" },
    { "calculate": "sequence(0, datum.icons)", "as": "arr" },
    { "flatten": ["arr"] },
    { "calculate": "datum.arr", "as": "i" },
    { "calculate": "datum.i % datum.wrap_per_row", "as": "col" },
    { "calculate": "floor(datum.i / datum.wrap_per_row)", "as": "row" },
    { "calculate": "16", "as": "row_step" },
    { "calculate": "datum.row * datum.row_step", "as": "yoff" }
  ],
  "layer": [
    {
      "mark": { "type": "text", "baseline": "middle", "align": "center" },
      "encoding": {
        "x": { "field": "col", "type": "quantitative", "axis": null, "scale": { "domain": [-0.5, 23.5] } },
        "y": {
          "field": "CountryLabel",
          "type": "nominal",
          "axis": null,
          "sort": { "field": "days", "op": "max", "order": "ascending" }
        },
        "yOffset": { "field": "yoff" },
        "text": { "value": "ðŸ“±" },
        "size": { "value": 40 },
        "tooltip": [
          { "field": "CountryLabel", "type": "nominal", "title": "Country" },
          { "field": "days", "type": "quantitative", "title": "Days" }
        ]
      }
    },
    {
      "transform": [
        { "aggregate": [{ "op": "max", "field": "row", "as": "max_row" }], "groupby": ["CountryLabel", "row_step"] },
        { "calculate": "(datum.max_row * datum.row_step) / 2", "as": "label_off" }
      ],
      "mark": { "type": "text", "align": "right", "baseline": "middle", "dx": -8 },
      "encoding": {
        "x": { "value": -0.2 },
        "y": {
          "field": "CountryLabel",
          "type": "nominal",
          "axis": null,
          "sort": { "field": "days", "op": "max", "order": "ascending" }
        },
        "yOffset": { "field": "label_off" },
        "text": { "field": "CountryLabel" },
        "size": { "value": 13 }
      }
    }
  ],
  "width": 780,
  "height": { "step": 26 },
  "bounds": "flush",
  "padding": 0,
  "config": { "view": { "stroke": null }, "axis": { "grid": false } }
}
